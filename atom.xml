<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>垚淼</title>
  
  <subtitle>花为什么美</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2022-06-11T11:59:04.932Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>垚淼</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Flutter调用android原生代码（插件开发）</title>
    <link href="http://yoursite.com/2022/06/11/19%E3%80%81Flutter%E8%B0%83%E7%94%A8android%E5%8E%9F%E7%94%9F%E4%BB%A3%E7%A0%81%EF%BC%88%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%EF%BC%89/"/>
    <id>http://yoursite.com/2022/06/11/19、Flutter调用android原生代码（插件开发）/</id>
    <published>2022-06-11T02:00:00.000Z</published>
    <updated>2022-06-11T11:59:04.932Z</updated>
    
    <content type="html"><![CDATA[<p>本文主要记录flutter插件开发，使用flutter调用android原生代码，android插件使用java语言，实现一个安装apk功能。<br><a href="https://github.com/lijmin/flutter_plugin_install_apk" target="_blank" rel="noopener">插件地址:https://github.com/lijmin/flutter_plugin_install_apk</a></p><h2 id="创建flutter插件"><a href="#创建flutter插件" class="headerlink" title="创建flutter插件"></a>创建flutter插件</h2><p><code>flutter create --platforms=android -a java --template=plugin install_apk</code><br>只需要android平台，使用语言是java</p><h2 id="添加dart接口"><a href="#添加dart接口" class="headerlink" title="添加dart接口"></a>添加dart接口</h2><p>lib目录下</p><ul><li><p>install_apk_platform_interface.dart 添加接口</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;<span class="built_in">Map</span>&gt; installApk(<span class="built_in">String</span> filePath) &#123;</span><br><span class="line">  <span class="keyword">throw</span> UnimplementedError(<span class="string">'installApk() has not been implemented.'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>install_apk_method_channel.dart 添加接口实现，调用android的installApk方法</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">Future&lt;<span class="built_in">Map</span>&gt; installApk(<span class="built_in">String</span> filePath) <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="built_in">Map</span>&lt;<span class="keyword">dynamic</span>, <span class="keyword">dynamic</span>&gt; map = &#123;<span class="string">"filePath"</span>:filePath&#125;;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> methodChannel.invokeMethod(<span class="string">'installApk'</span>, map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><a id="more"></a><h2 id="android-installApk方法实现"><a href="#android-installApk方法实现" class="headerlink" title="android installApk方法实现"></a>android installApk方法实现</h2><ul><li><p>从onAttachedToEngine方法获取context</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAttachedToEngine</span><span class="params">(@NonNull FlutterPluginBinding flutterPluginBinding)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    context = flutterPluginBinding.getApplicationContext();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>onMethodCall是方法入口，根据方法名称分发，并获取参数。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMethodCall</span><span class="params">(@NonNull MethodCall call, @NonNull Result result)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (call.method.equals(<span class="string">"installApk"</span>)) &#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = (Map&lt;String, Object&gt;) call.arguments;</span><br><span class="line">        String filePath = map.get(<span class="string">"filePath"</span>).toString();</span><br><span class="line">        Log.e(<span class="string">"TAG"</span>, filePath);</span><br><span class="line">        installAPK(filePath);</span><br><span class="line">        Map&lt;String, Object&gt; resp = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        resp.put(<span class="string">"code"</span>, <span class="number">1</span>);</span><br><span class="line">        resp.put(<span class="string">"msg"</span>, <span class="string">"install success"</span>);</span><br><span class="line">        result.success(resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>实现安装方法installAPK</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">installAPK</span><span class="params">(String filePath)</span> </span>&#123;</span><br><span class="line">  Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW);</span><br><span class="line">  Uri uri;</span><br><span class="line">  <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) &#123;</span><br><span class="line">    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK );</span><br><span class="line">    intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);</span><br><span class="line">    uri = FileProvider.getUriForFile(context, <span class="string">"com.lijmin.installer.provider"</span>, <span class="keyword">new</span> File(filePath));</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    uri = Uri.fromFile(<span class="keyword">new</span> File(filePath));</span><br><span class="line">  &#125;</span><br><span class="line">  intent.setDataAndType(uri,<span class="string">"application/vnd.android.package-archive"</span>);</span><br><span class="line">  context.startActivity(intent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>AndroidManifest.xml添加provider</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="tag">&lt;<span class="name">provider</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">"androidx.core.content.FileProvider"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:authorities</span>=<span class="string">"com.lijmin.installer.provider"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:exported</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:grantUriPermissions</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:name</span>=<span class="string">"android.support.FILE_PROVIDER_PATHS"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:resource</span>=<span class="string">"@xml/file_paths"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>添加file_paths资源文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">files-path</span> <span class="attr">path</span>=<span class="string">""</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>内部的element可以是files-path，cache-path，external-path，external-files-path，external-cache-path，<br>分别对应Context.getFilesDir()，Context.getCacheDir()，Environment.getExternalStorageDirectory()，Context.getExternalFilesDir()，Context.getExternalCacheDir()等几个方法。</p><ul><li>添加安装apk权限<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.REQUEST_INSTALL_PACKAGES"</span>/&gt;</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      使用flutter调用android原生代码，实现安装apk功能
    
    </summary>
    
    
      <category term="flutter" scheme="http://yoursite.com/tags/flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter中创建插件调用第三方的c库</title>
    <link href="http://yoursite.com/2022/04/13/18%E3%80%81Flutter%E4%B8%AD%E5%88%9B%E5%BB%BA%E6%8F%92%E4%BB%B6%E8%B0%83%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E7%9A%84c%E5%BA%93/"/>
    <id>http://yoursite.com/2022/04/13/18、Flutter中创建插件调用第三方的c库/</id>
    <published>2022-04-13T13:14:00.000Z</published>
    <updated>2022-04-13T16:11:38.978Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Flutter可直接调用android .so，ios .a库，有时候这个库需要通过c代码封装再提供给dart调用。<br>我们可通过dart:ffi来实现，在Flutter中创建插件调用第三方的c库。<br>github：<a href="https://github.com/lijmin/flutter_native_hello" target="_blank" rel="noopener">https://github.com/lijmin/flutter_native_hello</a></p><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><ol><li>创建android libhello.so库， 参考：<a href="https://lijmin.github.io/2022/03/20/15、android%20NDK引入第三方so库及头文件/" target="_blank" rel="noopener">https://lijmin.github.io/2022/03/20/15、android%20NDK引入第三方so库及头文件/</a></li><li>创建ios libhello.a库，参考：<a href="https://lijmin.github.io/2022/03/24/16、iOS生成.a静态库并引用/" target="_blank" rel="noopener">https://lijmin.github.io/2022/03/24/16、iOS生成.a静态库并引用/</a></li><li>分别添加getHelloWorld函数<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">getHelloWorld</span><span class="params">(<span class="keyword">char</span> *name)</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *hello = <span class="string">"Hello Android"</span>; <span class="comment">//iOS </span></span><br><span class="line">    <span class="keyword">char</span> *helloName = (<span class="keyword">char</span> *) <span class="built_in">malloc</span>(<span class="built_in">strlen</span>(hello) + <span class="built_in">strlen</span>(name));</span><br><span class="line">    <span class="built_in">strcpy</span>(helloName, hello);</span><br><span class="line">    <span class="built_in">strcat</span>(helloName, name);</span><br><span class="line">    <span class="keyword">return</span> helloName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><a id="more"></a><h2 id="创建Flutter插件"><a href="#创建Flutter插件" class="headerlink" title="创建Flutter插件"></a>创建Flutter插件</h2><p><code>flutter create --platforms=android,ios -a java -i swift --template=plugin native_hello</code><br>-a java 对应android开发语言，-i swift对应ios开发语言，尽量与项目保持一致，可减少项目配置。</p><h2 id="添加c代码"><a href="#添加c代码" class="headerlink" title="添加c代码"></a>添加c代码</h2><p>由于iOS不能把文件路径放于podspec之上，而android CMakeLists.txt 可以指定到ios目录，所以我们把c代码放在<code>ios/Classes/</code>目录下<br>创建native_hello.c，将hello.h文件放在同级目录，调用getHelloWorld方法。<br>native_hello.c<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"hello.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">getNativeTxt</span><span class="params">(<span class="keyword">char</span> *name)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getHelloWorld(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="android-加入libhello-so"><a href="#android-加入libhello-so" class="headerlink" title="android 加入libhello.so"></a>android 加入libhello.so</h3><ul><li>在android目录下创建libs文件夹，加入so库。</li><li>创建CMakeLists.txt</li></ul><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.4</span>.<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span>(../ios/Classes/hello.h) <span class="comment">#包含头文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">add_library</span>(hello SHARED IMPORTED)</span><br><span class="line"><span class="keyword">set_target_properties</span>(hello PROPERTIES IMPORTED_LOCATION <span class="variable">$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;</span>/libs/<span class="variable">$&#123;ANDROID_ABI&#125;</span>/libhello.so)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_library</span>( native_hello</span><br><span class="line">             SHARED</span><br><span class="line">             ../ios/Classes/native_hello.c )</span><br><span class="line"><span class="keyword">target_link_libraries</span>(native_hello hello)</span><br></pre></td></tr></table></figure><ul><li>build.gradle添加<code>externalNativeBuild</code></li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  externalNativeBuild &#123;</span><br><span class="line">    cmake &#123;</span><br><span class="line">      path <span class="string">"CMakeLists.txt"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>目录结构如下：</li></ul><p><img src="https://lijmin.github.io/00_blogImg/img_blog18_01.jpeg" alt=""></p><h3 id="iOS加入libhello-a"><a href="#iOS加入libhello-a" class="headerlink" title="iOS加入libhello.a"></a>iOS加入libhello.a</h3><ul><li>将libhello.a文件加入ios根目录</li><li>在根目录下的 .podspec配置 <code>s.vendored_libraries = &#39;libhello.a&#39;</code></li></ul><h2 id="dart调用native-hello-c"><a href="#dart调用native-hello-c" class="headerlink" title="dart调用native_hello.c"></a>dart调用native_hello.c</h2><ul><li>根据平台动态加载本地代码</li></ul><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'dart:ffi'</span>; <span class="comment">// For FFI</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'dart:io'</span>; <span class="comment">// For Platform.isX</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> DynamicLibrary nativeLib = Platform.isAndroid</span><br><span class="line">    ? DynamicLibrary.open(<span class="string">'libnative_hello.so'</span>)</span><br><span class="line">    : DynamicLibrary.process();</span><br></pre></td></tr></table></figure><ul><li>映射函数</li></ul><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Pointer&lt;Int8&gt; <span class="built_in">Function</span>(Pointer&lt;Int8&gt;) getNativeTxt = nativeLib</span><br><span class="line">    .lookup&lt;NativeFunction&lt;Pointer&lt;Int8&gt; <span class="built_in">Function</span>(Pointer&lt;Int8&gt;)&gt;&gt;(<span class="string">'getNativeTxt'</span>)</span><br><span class="line">    .asFunction();</span><br></pre></td></tr></table></figure><ul><li>类型映射表</li></ul><p><img src="https://lijmin.github.io/00_blogImg/img_blog18_02.jpeg" alt=""></p><ul><li><p>在main.dart中调用函数getNativeTxt </p></li><li><p>引入ffi插件，在pubspec.yaml中加入<code>ffi: ^1.1.2</code>，用于c字符串与dart字符串的映射</p></li><li><p>引入<code>package:ffi/ffi.dart</code></p></li></ul><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:ffi/ffi.dart'</span>;</span><br><span class="line"></span><br><span class="line">Pointer&lt;Int8&gt; dartString = <span class="string">" dart"</span>.toNativeUtf8().cast&lt;Int8&gt;();</span><br><span class="line">Pointer&lt;Int8&gt; res = getNativeTxt(dartString);</span><br><span class="line"><span class="built_in">String</span> nativeTxt = res.cast&lt;Utf8&gt;().toDartString();</span><br><span class="line"><span class="built_in">print</span>(nativeTxt);</span><br></pre></td></tr></table></figure><ul><li>最后记得内存释放</li></ul><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">malloc.free(dartString);</span><br><span class="line">malloc.free(res);</span><br></pre></td></tr></table></figure><ul><li>分别在ios、android上运行</li></ul><p><img src="https://lijmin.github.io/00_blogImg/img_blog18_03.png" alt=""><br><img src="https://lijmin.github.io/00_blogImg/img_blog18_04.jpeg" alt=""></p>]]></content>
    
    <summary type="html">
    
      通过dart:ffi来实现，在Flutter中创建插件调用第三方的c库
    
    </summary>
    
    
      <category term="flutter" scheme="http://yoursite.com/tags/flutter/"/>
    
  </entry>
  
  <entry>
    <title>CMake编译iOS静态库.a</title>
    <link href="http://yoursite.com/2022/03/27/17%E3%80%81CMAKE%E7%BC%96%E8%AF%91iOS/"/>
    <id>http://yoursite.com/2022/03/27/17、CMAKE编译iOS/</id>
    <published>2022-03-27T13:20:00.000Z</published>
    <updated>2022-03-27T14:11:44.315Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>mac操作系统使用CMake构建xcode项目，并编译iOS静态库。<br>CMake官网：<a href="https://cmake.org" target="_blank" rel="noopener">https://cmake.org</a><br>CMake文档：<a href="https://cmake.org/cmake/help/v3.23/manual/cmake-toolchains.7.html" target="_blank" rel="noopener">https://cmake.org/cmake/help/v3.23/manual/cmake-toolchains.7.html</a></p><h2 id="安装CMake"><a href="#安装CMake" class="headerlink" title="安装CMake"></a>安装CMake</h2><p>从官网下载最新版本的CMake并安装。<br>从指引安装命令行工具<br><a id="more"></a><br><img src="https://lijmin.github.io/00_blogImg/img_blog17_01.png" alt=""><br><img src="https://lijmin.github.io/00_blogImg/img_blog17_02.png" alt=""><br>一般安装第二条就可以使用了。<br>查看CMake版本号<code>cmake --version</code><br><img src="https://lijmin.github.io/00_blogImg/img_blog17_03.png" alt=""></p><h2 id="准备编译"><a href="#准备编译" class="headerlink" title="准备编译"></a>准备编译</h2><p>创建hello目录，作为源码目录。<br>创建hello.c放入目录。<br>在目录下创建CMakeLists.txt，内容如下：<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CMAKE_MINIMUM_REQUIRED</span>(VERSION <span class="number">3.23</span>) <span class="comment"># CMake版本</span></span><br><span class="line"><span class="keyword">PROJECT</span>(hello)</span><br><span class="line"><span class="keyword">ADD_LIBRARY</span>(hello STATIC hello.c) <span class="comment"># 源码，多个可用空格</span></span><br><span class="line"><span class="keyword">INSTALL</span>(TARGETS hello DESTINATION lib)</span><br></pre></td></tr></table></figure></p><h2 id="开始编译"><a href="#开始编译" class="headerlink" title="开始编译"></a>开始编译</h2><p>创建build目录，作为编译目录。<br>进入build目录开始构建项目<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cmake .. -G Xcode -T buildsystem=<span class="number">1</span> -DCMAKE_SYSTEM_NAME=iOS \</span><br><span class="line"><span class="string">"-DCMAKE_OSX_ARCHITECTURES=armv7;armv7s;arm64;x86_64"</span> \</span><br><span class="line">-DCMAKE_OSX_DEPLOYMENT_TARGET=<span class="number">9.3</span> \</span><br><span class="line">-DCMAKE_INSTALL_PREFIX=`pwd`/_install \</span><br><span class="line">-DCMAKE_XCODE_ATTRIBUTE_ONLY_ACTIVE_ARCH=NO \</span><br><span class="line">-DCMAKE_IOS_INSTALL_COMBINED=YES</span><br></pre></td></tr></table></figure></p><p>等待执行完成，可看到generation done.<br><img src="https://lijmin.github.io/00_blogImg/img_blog17_04.png" alt=""><br>执行编译命令<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake --build . --config Release --target <span class="keyword">install</span></span><br></pre></td></tr></table></figure></p><p>看到BUILD SUCCEEDED编译成功。<br><img src="https://lijmin.github.io/00_blogImg/img_blog17_05.png" alt=""><br>查看编译库信息：<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Lipo -info _install/lib/libhello.a</span><br></pre></td></tr></table></figure></p><p><img src="https://lijmin.github.io/00_blogImg/img_blog17_06.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      使用CMake构建xcode项目，编译iOS静态库
    
    </summary>
    
    
      <category term="CMake" scheme="http://yoursite.com/tags/CMake/"/>
    
  </entry>
  
  <entry>
    <title>iOS生成.a静态库并引用</title>
    <link href="http://yoursite.com/2022/03/24/16%E3%80%81iOS%E7%94%9F%E6%88%90.a%E9%9D%99%E6%80%81%E5%BA%93%E5%B9%B6%E5%BC%95%E7%94%A8/"/>
    <id>http://yoursite.com/2022/03/24/16、iOS生成.a静态库并引用/</id>
    <published>2022-03-24T04:21:00.000Z</published>
    <updated>2022-03-23T17:26:49.399Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在xcode上面生成iOS静态库.a文件，并引用。<br>项目地址 github：<a href="https://github.com/lijmin/ios_lib_test" target="_blank" rel="noopener">https://github.com/lijmin/ios_lib_test</a></p><h2 id="创建libhello-a"><a href="#创建libhello-a" class="headerlink" title="创建libhello.a"></a>创建libhello.a</h2><p>打开xcode，依次点击File-&gt;New-&gt;Project-&gt;Static Library创建项目<br><img src="https://lijmin.github.io/00_blogImg/img_blog16_01.png" alt=""><br><a id="more"></a><br>创建简单的c文件，添加add方法<br>hello.h<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> hello_h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> hello_h</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure></p><p>hello.c<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"hello.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>点击command+b编译，编译成功即可在Products目录下生成libhello.a。<br>右键libhello.a-&gt;Show in Filder，把libhello.a拷贝出来备用。</p><p>如果没有Products目录<br>到项目的目录下找hello.xcodeproj文件，右键显示包内容<br>然后打开project.pbxproj文件<br>搜索mainGroup，把mainGroup后面的内容复制到productRefGroup<br>回到xcode即可看到Products</p><h2 id="引用hello-a"><a href="#引用hello-a" class="headerlink" title="引用hello.a"></a>引用hello.a</h2><p>打开xcode，依次点击File-&gt;New-&gt;Project-&gt;app创建项目<br><img src="https://lijmin.github.io/00_blogImg/img_blog16_02.png" alt=""><br>创建hello文件夹，将hello.h、libhello.a拖入到文件夹下面<br><img src="https://lijmin.github.io/00_blogImg/img_blog16_03.png" alt=""><br>在ViewController.m里面调用hello.c的add方法<br><img src="https://lijmin.github.io/00_blogImg/img_blog16_04.png" alt=""><br>点击运行即可在控制台看到打印结果。<br><code>hello add = 3</code></p>]]></content>
    
    <summary type="html">
    
      iOS生成.a静态库并引用。
    
    </summary>
    
    
      <category term="iOS" scheme="http://yoursite.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>android NDK引入第三方so库及头文件</title>
    <link href="http://yoursite.com/2022/03/20/15%E3%80%81android%20NDK%E5%BC%95%E5%85%A5%E7%AC%AC%E4%B8%89%E6%96%B9so%E5%BA%93%E5%8F%8A%E5%A4%B4%E6%96%87%E4%BB%B6/"/>
    <id>http://yoursite.com/2022/03/20/15、android NDK引入第三方so库及头文件/</id>
    <published>2022-03-20T07:21:00.000Z</published>
    <updated>2022-03-23T16:07:10.304Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>主要讲述在android中调用一个没有jni接口的so动态库。由于第三方库没有jni接口，只能通过c++调用。我们用NDK创建自己的so库，并在自己的so库中调用第三方库中的接口。</p><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><ol><li>创建other.so库当作第三方的so库。</li><li>创建link_other.so库来调用other.so,并提供jni接口。</li><li>创建普通项目测试。<br>项目地址 github：<a href="https://github.com/lijmin/SO2NDK" target="_blank" rel="noopener">https://github.com/lijmin/SO2NDK</a></li></ol><a id="more"></a><h3 id="创建other-so"><a href="#创建other-so" class="headerlink" title="创建other.so"></a>创建other.so</h3><p>在android studio中创建native c++项目<br>File-&gt;New-&gt;New Project-&gt;Native C++<br><img src="https://lijmin.github.io/00_blogImg/img_blog15_01.png" alt=""><br>在cpp目录下创建other的C++类，并添加一个add方法<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"other.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> other::add(<span class="keyword">int</span> a, <span class="keyword">int</span> b) &#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>在CMakeLists.txt里面加入other.cpp<br><img src="https://lijmin.github.io/00_blogImg/img_blog15_02.png" alt=""><br>点击运行,在app-&gt;build-&gt;intermediates-&gt;cmake-&gt;debug-&gt;obj-&gt;x86目录下可看到生成到libother.so<br>配置多架构,在app的build.gradle配置abiFilters，然后点击构建。<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">android&#123;</span><br><span class="line">   ...</span><br><span class="line">   defaultConfig &#123;</span><br><span class="line">      ...</span><br><span class="line">      ndk&#123;  </span><br><span class="line">         moduleName <span class="string">"JniTest"</span>  </span><br><span class="line">         abiFilters <span class="string">"armeabi"</span>, <span class="string">"armeabi-v7a"</span>, <span class="string">"x86"</span>  </span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>将libother.so、other.h文件拷贝出来备用。</p><h3 id="创建link-other-so"><a href="#创建link-other-so" class="headerlink" title="创建link_other.so"></a>创建link_other.so</h3><p>直接在第一个项目上面改<br>把libother.so加入到libs目录<br>创建include目录并把other.h的头文件放到里面<br><img src="https://lijmin.github.io/00_blogImg/img_blog15_03.png" alt=""><br>修改CMakeList.txt，加入other.so<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置so库路径</span></span><br><span class="line">set(my_lib_path $&#123;CMAKE_SOURCE_DIR&#125;/../../../libs)</span><br><span class="line">add_library(other SHARED IMPORTED)</span><br><span class="line">set_target_properties(other PROPERTIES IMPORTED_LOCATION $&#123;my_lib_path&#125;/$&#123;ANDROID_ABI&#125;/libother.so)</span><br><span class="line">include_directories($&#123;CMAKE_SOURCE_DIR&#125;/<span class="keyword">include</span>/)</span><br><span class="line"></span><br><span class="line">add_library(link-other SHARED native-<span class="class"><span class="keyword">lib</span>.<span class="title">cpp</span>)</span></span><br><span class="line">find_library(log-<span class="class"><span class="keyword">lib</span> <span class="title">log</span>)</span></span><br><span class="line">target_link_libraries(link-other other $&#123;log-<span class="class"><span class="keyword">lib</span>&#125;)</span></span><br></pre></td></tr></table></figure></p><p>创建NDK方法，来调用other.so里面到add方法。<br><img src="https://lijmin.github.io/00_blogImg/img_blog15_04.png" alt=""><br><img src="https://lijmin.github.io/00_blogImg/img_blog15_05.png" alt=""><br>同样点击运行,在app-&gt;build-&gt;intermediates-&gt;cmake-&gt;debug-&gt;obj-&gt;x86目录下可看到生成了两个so文件。<br>这个时候在当前项目内是无法运行的，需要把两个so拿到测试项目运行。</p><h2 id="测试link-other-so"><a href="#测试link-other-so" class="headerlink" title="测试link-other.so"></a>测试link-other.so</h2><p>同样将两个so加入到新项目的libs<br>在app的build.gradle加入编译路径<br><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">android&#123;</span><br><span class="line">    ...</span><br><span class="line">    sourceSets &#123;</span><br><span class="line">        main &#123;</span><br><span class="line">            jniLibs.srcDirs = [<span class="string">'libs'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>创建与link-other.so相同包名类名的方法，并加载动态库。<br><img src="https://lijmin.github.io/00_blogImg/img_blog15_06.png" alt=""><br>在MainActivity里面调用native方法<br><img src="https://lijmin.github.io/00_blogImg/img_blog15_07.png" alt=""><br><img src="https://lijmin.github.io/00_blogImg/img_blog15_08.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      在android中调用一个没有jni接口的so动态库。
    
    </summary>
    
    
      <category term="android" scheme="http://yoursite.com/tags/android/"/>
    
      <category term="NDK" scheme="http://yoursite.com/tags/NDK/"/>
    
      <category term="so" scheme="http://yoursite.com/tags/so/"/>
    
  </entry>
  
  <entry>
    <title>mac搭建php开发环境</title>
    <link href="http://yoursite.com/2020/02/20/14%E3%80%81mac%E6%90%AD%E5%BB%BAphp%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
    <id>http://yoursite.com/2020/02/20/14、mac搭建php开发环境/</id>
    <published>2020-02-20T12:00:00.000Z</published>
    <updated>2022-03-20T15:19:52.750Z</updated>
    
    <content type="html"><![CDATA[<p>主要记录apache、php5.6、mysql5.7、eclipse在mac上的配置。</p><h3 id="apache"><a href="#apache" class="headerlink" title="apache"></a>apache</h3><p>  使用系统自带apache，修改网站路径，开启php模块。<br>  进入目录<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">/etc/apache2/</span></span><br></pre></td></tr></table></figure></p><p>备份并编辑httpd.conf<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp httpd<span class="selector-class">.conf</span> httpd<span class="selector-class">.conf</span><span class="selector-class">.bak</span></span><br><span class="line">sudo vim httpd.conf</span><br></pre></td></tr></table></figure></p><a id="more"></a><p>搜索DocumentRoot，并修改路径为你的网站根目录<br><img src="https://lijmin.github.io/00_blogImg/img_blog14_01.png" alt=""><br>搜索php，把php的加载模块打开。</p><p>sudo apachectl stop 停止<br>sudo apachectl start 启动</p><h3 id="php"><a href="#php" class="headerlink" title="php"></a>php</h3><p>  通过命令安装<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -s <span class="string">http:</span><span class="comment">//php-osx.liip.ch/install.sh | bash -s 5.6</span></span><br></pre></td></tr></table></figure></p><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><p>  mysql启动<br>  sudo launchctl unload -w /Library/LaunchDaemons/com.oracle.oss.mysql.mysqld.plist</p><p>2020-02-18T06:34:37.036622Z 1 [Note] A temporary password is generated for root@localhost: JeKjyZri8o)?</p><p>If you lose this password, please consult the section How to Reset the Root Password in the MySQL reference manual.</p><p>eclips</p><p>linux<br>修改目录权限<br>sudo chmod -R 777 xxx/</p>]]></content>
    
    <summary type="html">
    
      ionic4+angular7+cordova上传图片
    
    </summary>
    
    
      <category term="php" scheme="http://yoursite.com/tags/php/"/>
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
      <category term="apache" scheme="http://yoursite.com/tags/apache/"/>
    
  </entry>
  
  <entry>
    <title>ionic4+angular7+cordova上传图片</title>
    <link href="http://yoursite.com/2019/06/18/13%E3%80%81ionic4+angular7+cordova%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87/"/>
    <id>http://yoursite.com/2019/06/18/13、ionic4+angular7+cordova上传图片/</id>
    <published>2019-06-18T12:00:00.000Z</published>
    <updated>2022-03-20T03:32:31.002Z</updated>
    
    <content type="html"><![CDATA[<h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><p>安装插件Image Picker<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ionic cordova plugin add cordova-plugin-telerik-imagepicker</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install @ionic-native/image-picker</span></span><br></pre></td></tr></table></figure></p><p>安装插件File Transfer<br><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ionic cordova plugin add cordova-plugin-<span class="keyword">file</span>-<span class="built_in">transfer</span></span><br><span class="line">$ npm install @ionic-native/<span class="keyword">file</span>-<span class="built_in">transfer</span></span><br></pre></td></tr></table></figure></p><a id="more"></a><h3 id="添加到app-module-ts"><a href="#添加到app-module-ts" class="headerlink" title="添加到app.module.ts"></a>添加到app.module.ts</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ImagePicker &#125; <span class="keyword">from</span> <span class="string">'@ionic-native/image-picker/ngx'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; FileTransfer&#125; <span class="keyword">from</span> <span class="string">'@ionic-native/file-transfer/ngx'</span>;</span><br></pre></td></tr></table></figure><p><img src="https://lijmin.github.io/00_blogImg/img_blog13_01.png" alt=""></p><h3 id="html添加控件"><a href="#html添加控件" class="headerlink" title="html添加控件"></a>html添加控件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ion-button</span> (<span class="attr">click</span>)=<span class="string">"chooseImage()"</span>&gt;</span>上传图片<span class="tag">&lt;/<span class="name">ion-button</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="编辑ts文件"><a href="#编辑ts文件" class="headerlink" title="编辑ts文件"></a>编辑ts文件</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> UploadPage &#123;</span><br><span class="line"><span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">private</span> imagePicker: ImagePicker,</span></span><br><span class="line"><span class="params"><span class="keyword">private</span> transfer: FileTransfer</span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择图片，选择完成立即上传</span></span><br><span class="line">chooseImage() &#123;</span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">maximumImagesCount: <span class="number">1</span></span><br><span class="line"><span class="comment">// width: int,</span></span><br><span class="line"><span class="comment">// height: int,</span></span><br><span class="line"><span class="comment">// quality: int (0-100),</span></span><br><span class="line"><span class="comment">// outputType: int</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">this</span>.imagePicker.getPictures(options).then(<span class="function">(<span class="params">results</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> res of results) &#123;</span><br><span class="line"><span class="keyword">this</span>.upload(res);</span><br><span class="line">&#125;</span><br><span class="line">&#125;, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上传文件</span></span><br><span class="line">upload(file) &#123;</span><br><span class="line"><span class="keyword">const</span> fileTransfer: FileTransferObject = <span class="keyword">this</span>.transfer.create();</span><br><span class="line"><span class="keyword">const</span> options: FileUploadOptions = &#123;</span><br><span class="line">fileKey: <span class="string">'file'</span>,</span><br><span class="line">fileName: timestamp() + <span class="string">'.jpg'</span>,</span><br><span class="line">params: &#123;</span><br><span class="line"><span class="keyword">type</span>: <span class="string">'file'</span>,</span><br><span class="line">action: <span class="string">'upload'</span>,</span><br><span class="line">timestamp: timestamp(),</span><br><span class="line">auth_token: <span class="string">'79e1bd1504962034c068461d58b9cd89a1d8a4a1'</span></span><br><span class="line">&#125;,</span><br><span class="line">headers: &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">fileTransfer.upload(file, <span class="string">'https://imgbb.com'</span>, options)</span><br><span class="line">.then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">alert(<span class="string">'success'</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h3><p><img src="https://lijmin.github.io/00_blogImg/img_blog13_02.gif" alt=""></p>]]></content>
    
    <summary type="html">
    
      ionic4+angular7+cordova上传图片
    
    </summary>
    
    
      <category term="ionic4" scheme="http://yoursite.com/tags/ionic4/"/>
    
  </entry>
  
  <entry>
    <title>ionic4入门</title>
    <link href="http://yoursite.com/2019/06/08/12%E3%80%81ionic4%E5%85%A5%E9%97%A8/"/>
    <id>http://yoursite.com/2019/06/08/12、ionic4入门/</id>
    <published>2019-06-07T18:28:00.000Z</published>
    <updated>2022-03-20T03:32:16.046Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>ionic是一个垮平台开发框架，可通过web技术开发出多平台的应用。但只建议开发简单应用。复杂的应用需要用到许多cordova插件，而cordova插件的更新或者移动平台的更新很可能导致插件的不可用，维护升级成本较高。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ol><li>安装node.js。<a href="https://nodejs.org/en/" target="_blank" rel="noopener">https://nodejs.org/en/</a></li><li>通过node.j安装ionic<br><code>npm install -g ionic</code></li><li>查看安装情况<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">sh-3</span><span class="selector-class">.2</span># <span class="selector-tag">node</span> <span class="selector-tag">--version</span></span><br><span class="line"><span class="selector-tag">v10</span><span class="selector-class">.14</span><span class="selector-class">.2</span></span><br><span class="line"><span class="selector-tag">sh-3</span><span class="selector-class">.2</span># <span class="selector-tag">ionic</span> <span class="selector-tag">--version</span></span><br><span class="line">5<span class="selector-class">.0</span><span class="selector-class">.0</span></span><br></pre></td></tr></table></figure></li></ol><p>输出了版本好说明安装成功了。<br><a id="more"></a></p><h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><ol><li>创建myApp项目 <code>ionic start myApp tabs</code></li><li>进入myApp目录，运行项目 <code>cd myApp</code>、<code>ionic serve</code><br>这时可能会遇到问题<br><code>Error: Cannot find module &#39;node-sass’</code><br>安装相应的node-sass模块就可以了。<br><code>npm install node-sass --save-dev</code><br>没问题后可在浏览器看到项目运行起来了<br><img src="https://lijmin.github.io/00_blogImg/img_blog12_01.png" alt=""></li></ol><h2 id="添加ios平台"><a href="#添加ios平台" class="headerlink" title="添加ios平台"></a>添加ios平台</h2><ol><li>添加cordova插件 <code>npm i -g cordova</code></li><li>添加ios平台 <code>ionic cordova platform add ios</code></li><li>准备ios代码 <code>ionic cordova prepare ios</code>，以后都只需要这一步就可以在xcode上运行。</li><li>将生成的代码在xcode上运行<br><img src="https://lijmin.github.io/00_blogImg/img_blog12_02.png" alt=""></li><li>ios平台运行结果<br><img src="https://lijmin.github.io/00_blogImg/img_blog12_03.png" alt=""></li></ol><h2 id="添加android平台"><a href="#添加android平台" class="headerlink" title="添加android平台"></a>添加android平台</h2><ol><li>添加步骤同ios <code>ionic cordova platform add android</code><br>如遇到 <code>404 Not Found: amdroid@latest</code><br>先更新版本在尝试<br><code>ionic cordova platform rm android</code><br><code>ionic cordova platform update android</code><br><code>ionic cordova platform add android</code></li><li>在androidStudio运行android<br>可能会遇到构建异常<br><code>The minSdk version should not be declared in the android manifest file. You can move the version from the manifest to the defaultConfig in the build.gradle file.</code><br>在manifest把minSdkVersion删掉即可，目录是：<br>CordovaLib-&gt;AndroidManifest.xml<br>app-&gt;src-&gt;main-&gt;AndroidManifest.xml<br><code>&lt;uses-sdk android:minsdkversion=&quot;19&quot;&gt;</code></li><li>android平台也运行起来了<br><img src="https://lijmin.github.io/00_blogImg/img_blog12_04.png" alt=""></li></ol>]]></content>
    
    <summary type="html">
    
      ionic4+angular7+cordova开发入门
    
    </summary>
    
    
      <category term="ionic4" scheme="http://yoursite.com/tags/ionic4/"/>
    
  </entry>
  
  <entry>
    <title>android日历</title>
    <link href="http://yoursite.com/2018/11/02/11%E3%80%81android%E6%97%A5%E5%8E%86/"/>
    <id>http://yoursite.com/2018/11/02/11、android日历/</id>
    <published>2018-11-02T02:28:00.000Z</published>
    <updated>2018-11-02T14:37:43.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h3><p>github：<a href="https://github.com/jimmylee89/Calendar" target="_blank" rel="noopener">https://github.com/jimmylee89/Calendar</a></p><h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><ol><li>点击月份滚动到中间指示</li><li>日历可左右滑动</li><li>标记当前日期，设置点击效果</li></ol><h3 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h3><p><img src="https://github.com/jimmylee89/Calendar/raw/master/demo.gif" alt="效果图"></p>]]></content>
    
    <summary type="html">
    
      android自定义日历
    
    </summary>
    
    
      <category term="android" scheme="http://yoursite.com/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>android饼状图</title>
    <link href="http://yoursite.com/2018/03/11/10%E3%80%81android%E9%A5%BC%E7%8A%B6%E5%9B%BE/"/>
    <id>http://yoursite.com/2018/03/11/10、android饼状图/</id>
    <published>2018-03-11T01:20:00.000Z</published>
    <updated>2022-03-20T03:31:28.056Z</updated>
    
    <content type="html"><![CDATA[<h3 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h3><p>github：<a href="https://github.com/jimmylee89/ChartView" target="_blank" rel="noopener">https://github.com/jimmylee89/ChartView</a></p><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src="https://lijmin.github.io/00_blogImg/img_blog10_01.jpg" alt="效果图"><br><a id="more"></a></p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>gradle<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">implementation</span> <span class="string">'com.jimmylee.chartview:pieview:0.0.1'</span></span><br></pre></td></tr></table></figure></p><p>布局文件添加<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.jimmylee.pieview.PieView</span><br><span class="line">    android:<span class="attribute">id</span>=<span class="string">"@+id/pieView"</span></span><br><span class="line">    android:<span class="attribute">layout_width</span>=<span class="string">"100dp"</span></span><br><span class="line">    android:<span class="attribute">layout_height</span>=<span class="string">"100dp"</span></span><br><span class="line">    app:<span class="attribute">backgroundColor</span>=<span class="string">"#e5e5e5"</span></span><br><span class="line">    app:<span class="attribute">startAngle</span>=<span class="string">"138"</span> /&gt;</span><br></pre></td></tr></table></figure></p><p>java引用<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PieView pieView = findViewById(R.id.pieView);</span><br><span class="line"></span><br><span class="line">List&lt;Part&gt; parts = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">parts.add(<span class="keyword">new</span> Part(<span class="number">60</span>, ContextCompat.getColor(<span class="keyword">this</span>, R.color.colorPrimary)));</span><br><span class="line">parts.add(<span class="keyword">new</span> Part(<span class="number">100</span>, Color.GREEN));</span><br><span class="line">parts.add(<span class="keyword">new</span> Part(<span class="number">100</span>, Color.TRANSPARENT));</span><br><span class="line">parts.add(<span class="keyword">new</span> Part(<span class="number">100</span>, <span class="number">0xffff0000</span>));</span><br><span class="line">pieView.setParts(parts);</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      android自定义饼状图
    
    </summary>
    
    
      <category term="android" scheme="http://yoursite.com/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>android上传library到jcenter</title>
    <link href="http://yoursite.com/2018/02/02/9%E3%80%81android%E4%B8%8A%E4%BC%A0library%E5%88%B0jcenter/"/>
    <id>http://yoursite.com/2018/02/02/9、android上传library到jcenter/</id>
    <published>2018-02-02T00:54:12.000Z</published>
    <updated>2018-03-02T14:25:34.000Z</updated>
    
    <content type="html"><![CDATA[<p>1.注册bintray账号<a href="https://bintray.com" target="_blank" rel="noopener">https://bintray.com</a><br>2.创建maven仓库<br>3.android studio创建module<br>4.项目build.gradle文件添加插件<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">        <span class="keyword">classpath</span> <span class="string">'com.jfrog.bintray.gradle:gradle-bintray-plugin:1.0'</span></span><br><span class="line">        <span class="keyword">classpath</span> <span class="string">'com.github.dcendents:android-maven-gradle-plugin:1.5'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><a id="more"></a><p>5.module下的build.gradle文件添加配置  </p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根节点添加</span></span><br><span class="line">apply plugin: <span class="string">'com.github.dcendents.android-maven'</span></span><br><span class="line">apply plugin: <span class="string">'com.jfrog.bintray'</span></span><br><span class="line">version = <span class="string">"0.0.1"</span></span><br><span class="line"><span class="keyword">def</span> siteUrl = <span class="string">'https://github.com/jimmylee89/ChartView'</span>    <span class="comment">// project homepage</span></span><br><span class="line"><span class="keyword">def</span> gitUrl = <span class="string">'https://github.com/jimmylee89/ChartView.git'</span> <span class="comment">// project git</span></span><br><span class="line"><span class="keyword">group</span> = <span class="string">"com.jimmylee.chartview"</span> <span class="comment">//组名称可以自己定</span></span><br><span class="line"><span class="keyword">task</span> sourcesJar(type: Jar) &#123;</span><br><span class="line">    <span class="keyword">from</span> android.<span class="keyword">sourceSets</span>.main.java.srcDirs</span><br><span class="line">    classifier = <span class="string">'sources'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">task</span> javadoc(type: Javadoc) &#123;</span><br><span class="line">    <span class="keyword">source</span> = android.<span class="keyword">sourceSets</span>.main.java.srcDirs</span><br><span class="line">    <span class="keyword">classpath</span> += <span class="keyword">project</span>.files(android.getBootClasspath().<span class="keyword">join</span>(<span class="keyword">File</span>.pathSeparator))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">task</span> javadocJar(type: Jar, dependsOn: javadoc) &#123;</span><br><span class="line">    classifier = <span class="string">'javadoc'</span></span><br><span class="line">    <span class="keyword">from</span> javadoc.<span class="keyword">destinationDir</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">artifacts</span> &#123;</span><br><span class="line">    archives javadocJar</span><br><span class="line">    archives sourcesJar</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 根节点添加</span></span><br><span class="line">install &#123;</span><br><span class="line">    <span class="keyword">repositories</span>.mavenInstaller &#123;</span><br><span class="line">        <span class="comment">// This generates POM.xml with proper parameters</span></span><br><span class="line">        pom &#123;</span><br><span class="line">            <span class="keyword">project</span> &#123;</span><br><span class="line">                packaging <span class="string">'aar'</span></span><br><span class="line">                name <span class="string">'chartview'</span></span><br><span class="line">                url siteUrl</span><br><span class="line">                <span class="comment">// Set your license</span></span><br><span class="line">                licenses &#123;</span><br><span class="line">                    license &#123;</span><br><span class="line">                        name <span class="string">'The Apache Software License, Version 2.0'</span></span><br><span class="line">                        url <span class="string">'http://www.apache.org/licenses/LICENSE-2.0.txt'</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                developers &#123;</span><br><span class="line">                    developer &#123; <span class="comment">//填写的一些基本信息</span></span><br><span class="line">                        id <span class="string">'jimmylee'</span></span><br><span class="line">                        name <span class="string">'jimmylee'</span></span><br><span class="line">                        email <span class="string">'371128340@qq.com'</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                scm &#123;</span><br><span class="line">                    connection gitUrl</span><br><span class="line">                    developerConnection gitUrl</span><br><span class="line">                    url siteUrl</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//配置bintray参数</span></span><br><span class="line">Properties properties = <span class="keyword">new</span> Properties()</span><br><span class="line">properties.load(<span class="keyword">project</span>.rootProject.<span class="keyword">file</span>(<span class="string">'local.properties'</span>).newDataInputStream())</span><br><span class="line">bintray &#123;</span><br><span class="line">    user = properties.getProperty(<span class="string">"bintrayUser"</span>)</span><br><span class="line">    key = properties.getProperty(<span class="string">"bintrayApiKey"</span>)</span><br><span class="line">    <span class="keyword">configurations</span> = [<span class="string">'archives'</span>]</span><br><span class="line">    pkg &#123;</span><br><span class="line">        repo = <span class="string">"maven"</span>               <span class="comment">//跟bintray仓库名字保持一致</span></span><br><span class="line">        name = <span class="string">"pieview"</span>                <span class="comment">//发布到JCenter上的项目名字</span></span><br><span class="line">        websiteUrl = siteUrl</span><br><span class="line">        vcsUrl = gitUrl</span><br><span class="line">        licenses = [<span class="string">"Apache-2.0"</span>]</span><br><span class="line">        publish = <span class="keyword">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>6.项目local.properties文件添加bintray的帐号密匙</p><pre><code>bintrayUser=用户名bintrayApiKey=密匙</code></pre><p>7.android studio terminal 执行<code>./gradlew install</code>  <code>./gradlew clean build bintrayUpload</code></p>]]></content>
    
    <summary type="html">
    
      android上传library到jcenter
    
    </summary>
    
    
      <category term="android" scheme="http://yoursite.com/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>AndroidStudio更新gradle</title>
    <link href="http://yoursite.com/2018/01/27/8%E3%80%81AndroidStudio%E6%9B%B4%E6%96%B0gradle/"/>
    <id>http://yoursite.com/2018/01/27/8、AndroidStudio更新gradle/</id>
    <published>2018-01-27T12:25:12.000Z</published>
    <updated>2022-03-20T03:30:14.614Z</updated>
    
    <content type="html"><![CDATA[<p>android studio 创建项目时，卡在building界面，如图：<br><img src="https://lijmin.github.io/00_blogImg/img_blog8_01.png" alt=""><br>可能是在更新gradle，由于网络问题下载速度很慢。如果你有足够的耐心，可以等到它更新完。或者使用梯子可以提高一点下载速度。<br>下面说的是本地更新的方法:<br><a id="more"></a><br>打开项目的gradle-wrapper.properties文件，可以看到如下内容<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">distributionBase</span>=GRADLE_USER_HOME</span><br><span class="line"><span class="attr">distributionPath</span>=wrapper/dists</span><br><span class="line"><span class="attr">zipStoreBase</span>=GRADLE_USER_HOME</span><br><span class="line"><span class="attr">zipStorePath</span>=wrapper/dists</span><br><span class="line"><span class="attr">distributionUrl</span>=https\://services.gradle.org/distributions/gradle-<span class="number">4.4</span>.<span class="number">1</span>-all.zip</span><br></pre></td></tr></table></figure></p><p>distributionUrl就是下载路径。先拷贝路径用迅雷下载，保存在本地。<br>然后把distributionUrl替换为<code>distributionUrl=file\:/Users/***/gradle-4.4.1-all.zip</code><br>重新构建项目就可以了。</p>]]></content>
    
    <summary type="html">
    
      Mac系统下更新AndroidStudio gradle
    
    </summary>
    
    
      <category term="android studio" scheme="http://yoursite.com/tags/android-studio/"/>
    
      <category term="gradle" scheme="http://yoursite.com/tags/gradle/"/>
    
  </entry>
  
  <entry>
    <title>android编译过程</title>
    <link href="http://yoursite.com/2016/06/11/7%E3%80%81android%E7%BC%96%E7%A8%8B01%EF%BC%8D%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B/"/>
    <id>http://yoursite.com/2016/06/11/7、android编程01－编译过程/</id>
    <published>2016-06-11T04:20:00.000Z</published>
    <updated>2016-06-11T13:20:52.000Z</updated>
    
    <content type="html"><![CDATA[<ol><li>res/目录下的xml文件和AndroidManifest.xml通过资源打包工具（aapt）生成已编译资源和R.java。</li><li>编译java源码，生成java字节码（.class）文件。</li><li>交叉编译生成dalvik字节码（.dex）。</li><li>.dex和已编译资源，签名部署成apk（.apk）。</li></ol>]]></content>
    
    <summary type="html">
    
      android编译过程
    
    </summary>
    
    
      <category term="android" scheme="http://yoursite.com/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>Mac配置android adb环境变量</title>
    <link href="http://yoursite.com/2016/06/04/6%E3%80%81Mac%E9%85%8D%E7%BD%AEandroid%20adb%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"/>
    <id>http://yoursite.com/2016/06/04/6、Mac配置android adb环境变量/</id>
    <published>2016-06-04T14:43:12.000Z</published>
    <updated>2018-01-18T13:09:08.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Lunix基本操作"><a href="#Lunix基本操作" class="headerlink" title="Lunix基本操作"></a>Lunix基本操作</h3><ol><li>sudo 以root用户的权限操作</li><li>chmod 修改文件的权限</li><li>vim 编辑文件<br>a) i进入编辑模式<br>b) u撤销,ctrl+r反撤销<br>c) :q退出，:wq保存退出</li></ol><a id="more"></a><h3 id="配置adb"><a href="#配置adb" class="headerlink" title="配置adb"></a>配置adb</h3><ol><li>找到adb安装位置,一般是在/Users/ljm/Library/Android/sdk/platforms </li><li>修改etc目录下auto_master文件，/home前面加＃，然后执行:<code>sudo automount</code>在不重启电脑的情况下重新加载这个文件</li><li>在／home目录下添加文件,<code>touch .bash_profile</code></li><li>编辑.bash_profile，<code>vim .bash_profile</code> 添加adb安装路径<code>export PATH=${PATH}:/Users/ljm/Library/Android/sdk/platform-tools</code></li><li>执行<code>source .bash_profile</code>加载这个文件，执行<code>adb version</code>查看是否安装成功，如果成功会显示版本号<br><b>到这里配置已经完成，但不会开机启动</b></li></ol><h3 id="设置开机启动"><a href="#设置开机启动" class="headerlink" title="设置开机启动"></a>设置开机启动</h3><ol><li>修改／etc/bashrc文件，在最后面添加<code>. /home/.bash_profile</code></li><li>如果文件没有权限,先设置权限<code>chmod 777 /etc/bashrc</code>设置所有权限</li><li>重启电脑查看效果，成功之后可以把权限改回来</li></ol><h3 id="补充权限知识"><a href="#补充权限知识" class="headerlink" title="补充权限知识"></a>补充权限知识</h3><p>第一个数字表示文件所有者的权限<br>第二个数字表示与文件所有者同属一个用户组的其他用户的权限<br>第三个数字表示其它用户组的权限。</p><p>权限分为三种：读（r=4），写（w=2），执行（x=1）。综合起来还有可读可执行（rx=5=4+1）、可读可写（rw=6=4+2）、可读可写可执行(rwx=7=4+2+1)。</p>]]></content>
    
    <summary type="html">
    
      Mac配置android adb环境变量
    
    </summary>
    
    
      <category term="mac" scheme="http://yoursite.com/tags/mac/"/>
    
  </entry>
  
  <entry>
    <title>Mac使用hexo搭建博客</title>
    <link href="http://yoursite.com/2015/10/01/5%E3%80%81Mac%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/"/>
    <id>http://yoursite.com/2015/10/01/5、Mac使用hexo搭建博客/</id>
    <published>2015-10-01T01:43:12.000Z</published>
    <updated>2016-06-05T08:50:11.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装git</h3><p><a href="http://www.git-scm.com/download/" target="_blank" rel="noopener">git官网</a>下载对应的安装包。<br>安装成功后打开terminal，执行：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git --version</span></span><br></pre></td></tr></table></figure></p><p>可以看的版本号 git version 2.3.2 (Apple Git-55)</p><h3 id="安装node-js"><a href="#安装node-js" class="headerlink" title="安装node.js"></a>安装node.js</h3><p><a href="https://nodejs.org/download/" target="_blank" rel="noopener">nodejs官网</a>下载对应的版本安装。<br>安装成功后，执行：<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">node</span> <span class="title">-v</span></span><br></pre></td></tr></table></figure></p><p>可以看到版本号 v0.12.4</p><a id="more"></a><h3 id="安装hexo"><a href="#安装hexo" class="headerlink" title="安装hexo"></a>安装hexo</h3><p>打开terminal执行：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo npm install -g hexo</span></span><br></pre></td></tr></table></figure></p><p>如果遇到 Permission denied的问题，可尝试先设置一下npm权限：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm<span class="built_in"> config </span><span class="builtin-name">set</span><span class="built_in"> user </span>0 </span><br><span class="line">$ npm<span class="built_in"> config </span><span class="builtin-name">set</span> unsafe-perm <span class="literal">true</span></span><br></pre></td></tr></table></figure></p><p>安装完成执行 <code>hexo v</code> 可以看到以下信息<br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ hexo v</span><br><span class="line">hexo-<span class="keyword">cli</span>: <span class="number">0.1</span><span class="number">.6</span></span><br><span class="line"><span class="symbol">os:</span> Darwin <span class="number">14.3</span><span class="number">.0</span> darwin x64</span><br><span class="line"><span class="symbol">http_parser:</span> <span class="number">2.3</span></span><br><span class="line"><span class="symbol">node:</span> <span class="number">0.12</span><span class="number">.4</span></span><br><span class="line"><span class="symbol">v8:</span> <span class="number">3.28</span><span class="number">.71</span><span class="number">.19</span></span><br><span class="line"><span class="symbol">uv:</span> <span class="number">1.5</span><span class="number">.0</span></span><br><span class="line"><span class="symbol">zlib:</span> <span class="number">1.2</span><span class="number">.8</span></span><br><span class="line"><span class="symbol">modules:</span> <span class="number">14</span></span><br><span class="line"><span class="symbol">openssl:</span> <span class="number">1.0</span><span class="number">.1</span>m</span><br></pre></td></tr></table></figure></p><h3 id="搭建博客"><a href="#搭建博客" class="headerlink" title="搭建博客"></a>搭建博客</h3><p>创建一个本地目录，比如blog。<br>打开terminal，进到这个目录，执行<code>hexo init</code>开始初始化。完成后可以看到以下信息：<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init</span><br><span class="line">INFO  Copying data <span class="keyword">to</span> 你的目录</span><br><span class="line">INFO  You are almost done! Don't forget <span class="keyword">to</span> <span class="built_in">run</span> 'npm install' <span class="keyword">before</span> you start blogging <span class="keyword">with</span> Hexo!</span><br></pre></td></tr></table></figure></p><p>然后执行<code>$ npm install hexo --save</code>等待安装。<br>安装完成后执行<code>$ hexo g</code>构建 <code>$ hexo s</code>启动，在浏览器输入<br><a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a> 就可以看到你的静态网页了。</p>]]></content>
    
    <summary type="html">
    
      Mac使用hexo搭建博客
    
    </summary>
    
    
      <category term="hexo" scheme="http://yoursite.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>Mac控制台命令</title>
    <link href="http://yoursite.com/2015/06/07/4%E3%80%81Mac%E5%91%BD%E4%BB%A4/"/>
    <id>http://yoursite.com/2015/06/07/4、Mac命令/</id>
    <published>2015-06-07T01:43:12.000Z</published>
    <updated>2018-03-11T05:06:52.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="基本操作命令"><a href="#基本操作命令" class="headerlink" title="基本操作命令"></a>基本操作命令</h3><ul><li>进入根目录 <code>cd /</code></li><li>查看目录下的所有文件 <code>ls</code></li><li>进入下级目录 <code>cd Users</code>（Users表示目录名）</li><li>进入指定目录 <code>cd /Users/lijiamin/Library/Saved\ Searches/jimmy/swift</code>，cd ＋ 目录名，也可以cd ＋ 拖动文件夹到terminal</li><li>删除文件 <code>rm document</code> （删除一个叫document的文件）</li><li>显示隐藏文件 defaults write com.apple.finder AppleShowAllFiles -bool true（false为隐藏）</li><li>将文件内容追加到另外一个文件上 cat /mnt/gitData/gitPub/MacLijiamin/id_rsa.pub &gt;&gt;/home/git/.ssh/authorized_keys</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;基本操作命令&quot;&gt;&lt;a href=&quot;#基本操作命令&quot; class=&quot;headerlink&quot; title=&quot;基本操作命令&quot;&gt;&lt;/a&gt;基本操作命令&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;进入根目录 &lt;code&gt;cd /&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;查看目录下的所有文件 &lt;cod
      
    
    </summary>
    
    
      <category term="mac" scheme="http://yoursite.com/tags/mac/"/>
    
  </entry>
  
  <entry>
    <title>移动硬盘装win7</title>
    <link href="http://yoursite.com/2012/08/08/3%E3%80%81%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98%E8%A3%85win7/"/>
    <id>http://yoursite.com/2012/08/08/3、移动硬盘装win7/</id>
    <published>2012-08-07T16:19:00.000Z</published>
    <updated>2018-01-18T13:08:12.000Z</updated>
    
    <content type="html"><![CDATA[<p><span style="font-size: 16px;">总结一下用移动硬盘装win7的方法</span></p><p><span style="font-size: 16px;">1、给移动硬盘分区（分区是为了方便管理）</span></p><p><span style="font-size: 16px;">　　我是在win7系统上分区的。控制面板–&gt;系统与安全–&gt;创建并格式化硬盘分区，进去之后选择你的移动硬盘–&gt;删除卷（会丢失数据的，建议用分区工具，我的移动硬盘是空的就无所谓了）–&gt;在下面找到未分配区–&gt;右击–&gt;新建分区（输入你要划分的大小就可以了，这里新建的都是主分区，主分区只有3个，如果需要划分多个，就在主分区上扩展卷）</span></p><p><span style="font-size: 16px;">右击你要放系统的分区–&gt;将分区标记为活动分区（设置分区为可引导）</span></p><a id="more"></a><p><span style="font-size: 16px;">2、下载旗舰版win7系统（GHOST版安装失败，可能是之前方法错误，后来也没再试）</span></p><p><span style="font-size: 16px;">　　把ISO系统文件解压到移动硬盘分区的根目录上（是根目录，不然安装时会报错BOOTMGR is missing).</span></p><p><span style="font-size: 16px;">3、设置USB启动</span></p><p><span style="font-size: 16px;">　　开机按F2(有的机器不是F2，有的F1、F10.都按一下就知道了)进入BIOS–&gt;Boot（把USB-HDD调到第一位置）</span></p><p><span style="font-size: 16px;">4、重启电脑，开始安装。跟光驱安装一样，速度更快一些</span></p><p><span style="font-size: 16px;">&nbsp;</span></p><p><span style="font-size: 16px;">PS：重装前最好先备份好驱动，有时需要网卡驱动，上不了网是比较纠结的。</span></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;总结一下用移动硬盘装win7的方法&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;1、给移动硬盘分区（分区是为了方便管理）&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;　　我是在win7系统上分区的。控制面板–&amp;gt;系统与安全–&amp;gt;创建并格式化硬盘分区，进去之后选择你的移动硬盘–&amp;gt;删除卷（会丢失数据的，建议用分区工具，我的移动硬盘是空的就无所谓了）–&amp;gt;在下面找到未分配区–&amp;gt;右击–&amp;gt;新建分区（输入你要划分的大小就可以了，这里新建的都是主分区，主分区只有3个，如果需要划分多个，就在主分区上扩展卷）&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;右击你要放系统的分区–&amp;gt;将分区标记为活动分区（设置分区为可引导）&lt;/span&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="windows" scheme="http://yoursite.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>网页中加入百度地图（带地区搜索）</title>
    <link href="http://yoursite.com/2012/07/27/2%E3%80%81%E7%BD%91%E9%A1%B5%E4%B8%AD%E5%8A%A0%E5%85%A5%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE%EF%BC%88%E5%B8%A6%E5%9C%B0%E5%8C%BA%E6%90%9C%E7%B4%A2%EF%BC%89/"/>
    <id>http://yoursite.com/2012/07/27/2、网页中加入百度地图（带地区搜索）/</id>
    <published>2012-07-27T13:06:00.000Z</published>
    <updated>2015-06-07T07:47:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>&nbsp;先看效果：</p><!--引用百度地图API--><p><style>&lt;!–<br>.iw_poi_title {<br>    color: #CC5522;<br>    font-size: 14px;<br>    font-weight: bold;<br>    overflow: hidden;<br>    padding-right: 13px;<br>    white-space: nowrap<br>}</p><p>.iw_poi_content {<br>    font: 12px arial, sans-serif;<br>    overflow: visible;<br>    padding-top: 4px;<br>    white-space: -moz-pre-wrap;<br>    word-wrap: break-word<br>}<br>–&gt;</style></p><script type="text/javascript" src="http://api.map.baidu.com/api?key=&amp;v=1.1&amp;services=true">// <![CDATA[// ]]&gt;</script><!--百度地图容器--><div id="dituContent" style="width: 600px; height: 450px; border: #ccc solid 1px; margin-bottom: 20px;">&nbsp;</div><div><input id="input" type="text"> <input onclick="searchMap();" type="button" value="搜索地图"></div><div>&nbsp;</div><div>实现步骤：</div><div>1、到百度aip示例学习获取代码&nbsp;[http://api.map.baidu.com/lbsapi/creatmap/index.html](http://api.map.baidu.com/lbsapi/creatmap/index.html)</div><div>&nbsp;</div><div>2、代码注释很详细，其中创建地图时是通过经纬度定位的。修改一下，我们通过传参的方式。</div><div><div class="cnblogs_code"><pre><span style="color: #008000;">//</span><span style="color: #008000;">创建地图函数：</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> createMap(x, y) {    </span><span style="color: #0000ff;">var</span> map = <span style="color: #0000ff;">new</span> BMap.Map("dituContent");<span style="color: #008000;">//</span><span style="color: #008000;">在百度地图容器中创建一个地图</span>    <span style="color: #0000ff;">var</span> point = <span style="color: #0000ff;">new</span> BMap.Point(x, y);<span style="color: #008000;">//</span><span style="color: #008000;">定义一个中心点坐标</span>    map.centerAndZoom(point, 12);<span style="color: #008000;">//</span><span style="color: #008000;">设定地图的中心点和坐标并将地图显示在地图容器中</span>    window.map = map;<span style="color: #008000;">//</span><span style="color: #008000;">将map变量存储在全局</span>}</pre></div>3、添加文本框、按钮，点击按钮的时候把文本框的内容传给javascript。<div class="cnblogs_code"><pre>&lt;div&gt;    &lt;input type="text" id="input" /&gt;    &lt;input type="button" onclick="searchMap();" value="搜索地图" /&gt;&lt;/div&gt;</pre></div>4、javascript将地区转化为经纬度，重新创建地图。<div class="cnblogs_code"><pre><span style="color: #0000ff;">function</span><span style="color: #000000;"> searchMap() {    </span><span style="color: #0000ff;">var</span> area = document.getElementById("input").value; <span style="color: #008000;">//</span><span style="color: #008000;">得到地区</span>    <span style="color: #0000ff;">var</span> ls = <span style="color: #0000ff;">new</span><span style="color: #000000;"> BMap.LocalSearch(map);    ls.setSearchCompleteCallback(</span><span style="color: #0000ff;">function</span><span style="color: #000000;">(rs) {        </span><span style="color: #0000ff;">if</span> (ls.getStatus() ==<span style="color: #000000;"> BMAP_STATUS_SUCCESS) {            </span><span style="color: #0000ff;">var</span> poi = rs.getPoi(0<span style="color: #000000;">);            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (poi) {                createMap(poi.point.lng, poi.point.lat);</span><span style="color: #008000;">//</span><span style="color: #008000;">创建地图(经度poi.point.lng,纬度poi.point.lat)</span>                setMapEvent();<span style="color: #008000;">//</span><span style="color: #008000;">设置地图事件</span>                addMapControl();<span style="color: #008000;">//</span><span style="color: #008000;">向地图添加控件</span><span style="color: #000000;">            }        }    });    ls.search(area);}</span></pre></div>&nbsp;完整代码:<div class="cnblogs_code"><pre>&lt;!--引用百度地图API--&gt;&lt;style type="text/css"&gt;<span style="color: #000000;">.iw_poi_title {    color: #CC5522;    font</span>-<span style="color: #000000;">size: 14px;    font</span>-<span style="color: #000000;">weight: bold;    overflow: hidden;    padding</span>-<span style="color: #000000;">right: 13px;    white</span>-<span style="color: #000000;">space: nowrap}.iw_poi_content {    font: 12px arial, sans</span>-<span style="color: #000000;">serif;    overflow: visible;    padding</span>-<span style="color: #000000;">top: 4px;    white</span>-space: -moz-pre-<span style="color: #000000;">wrap;    word</span>-wrap: <span style="color: #0000ff;">break</span>-<span style="color: #000000;">word}</span>&lt;/style&gt;&lt;script type="text/javascript"<span style="color: #000000;">    src</span>="http://api.map.baidu.com/api?key=&amp;v=1.1&amp;services=true"&gt;&lt;/script&gt;&lt;!--百度地图容器--&gt;&lt;<span style="color: #000000;">div    style</span>="width: 600px; height: 450px; border: #ccc solid 1px; margin-bottom: 20px;"<span style="color: #000000;">    id</span>="dituContent"&gt;&lt;/div&gt;&lt;div&gt;    &lt;input type="text" id="input" /&gt;    &lt;input type="button" onclick="searchMap();" value="搜索地图" /&gt;&lt;/div&gt;&lt;script type="text/javascript"&gt;<span style="color: #008000;">//</span><span style="color: #008000;">创建和初始化地图函数：</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> initMap() {    createMap(</span>114.025974, 22.546054);<span style="color: #008000;">//</span><span style="color: #008000;">创建地图</span>    setMapEvent();<span style="color: #008000;">//</span><span style="color: #008000;">设置地图事件</span>    addMapControl();<span style="color: #008000;">//</span><span style="color: #008000;">向地图添加控件</span><span style="color: #000000;">}</span><span style="color: #008000;">//</span><span style="color: #008000;">地图搜索</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> searchMap() {    </span><span style="color: #0000ff;">var</span> area = document.getElementById("input").value; <span style="color: #008000;">//</span><span style="color: #008000;">得到地区</span>    <span style="color: #0000ff;">var</span> ls = <span style="color: #0000ff;">new</span><span style="color: #000000;"> BMap.LocalSearch(map);    ls.setSearchCompleteCallback(</span><span style="color: #0000ff;">function</span><span style="color: #000000;">(rs) {        </span><span style="color: #0000ff;">if</span> (ls.getStatus() ==<span style="color: #000000;"> BMAP_STATUS_SUCCESS) {            </span><span style="color: #0000ff;">var</span> poi = rs.getPoi(0<span style="color: #000000;">);            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (poi) {                createMap(poi.point.lng, poi.point.lat);</span><span style="color: #008000;">//</span><span style="color: #008000;">创建地图(经度poi.point.lng,纬度poi.point.lat)</span>                setMapEvent();<span style="color: #008000;">//</span><span style="color: #008000;">设置地图事件</span>                addMapControl();<span style="color: #008000;">//</span><span style="color: #008000;">向地图添加控件</span><span style="color: #000000;">            }        }    });    ls.search(area);}</span><span style="color: #008000;">//</span><span style="color: #008000;">创建地图函数：</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> createMap(x, y) {    </span><span style="color: #0000ff;">var</span> map = <span style="color: #0000ff;">new</span> BMap.Map("dituContent");<span style="color: #008000;">//</span><span style="color: #008000;">在百度地图容器中创建一个地图</span>    <span style="color: #0000ff;">var</span> point = <span style="color: #0000ff;">new</span> BMap.Point(x, y);<span style="color: #008000;">//</span><span style="color: #008000;">定义一个中心点坐标</span>    map.centerAndZoom(point, 12);<span style="color: #008000;">//</span><span style="color: #008000;">设定地图的中心点和坐标并将地图显示在地图容器中</span>    window.map = map;<span style="color: #008000;">//</span><span style="color: #008000;">将map变量存储在全局</span><span style="color: #000000;">}</span><span style="color: #008000;">//</span><span style="color: #008000;">地图事件设置函数：</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> setMapEvent() {    map.enableDragging();</span><span style="color: #008000;">//</span><span style="color: #008000;">启用地图拖拽事件，默认启用(可不写)</span>    map.enableScrollWheelZoom();<span style="color: #008000;">//</span><span style="color: #008000;">启用地图滚轮放大缩小</span>    map.enableDoubleClickZoom();<span style="color: #008000;">//</span><span style="color: #008000;">启用鼠标双击放大，默认启用(可不写)</span>    map.enableKeyboard();<span style="color: #008000;">//</span><span style="color: #008000;">启用键盘上下左右键移动地图</span><span style="color: #000000;">}</span><span style="color: #008000;">//</span><span style="color: #008000;">地图控件添加函数：</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> addMapControl() {    </span><span style="color: #008000;">//</span><span style="color: #008000;">向地图中添加缩放控件</span>    <span style="color: #0000ff;">var</span> ctrl_nav = <span style="color: #0000ff;">new</span><span style="color: #000000;"> BMap.NavigationControl( {        anchor : BMAP_ANCHOR_TOP_LEFT,        type : BMAP_NAVIGATION_CONTROL_LARGE    });    map.addControl(ctrl_nav);    </span><span style="color: #008000;">//</span><span style="color: #008000;">向地图中添加缩略图控件</span>    <span style="color: #0000ff;">var</span> ctrl_ove = <span style="color: #0000ff;">new</span><span style="color: #000000;"> BMap.OverviewMapControl( {        anchor : BMAP_ANCHOR_BOTTOM_RIGHT,        isOpen : </span>1<span style="color: #000000;">    });    map.addControl(ctrl_ove);    </span><span style="color: #008000;">//</span><span style="color: #008000;">向地图中添加比例尺控件</span>    <span style="color: #0000ff;">var</span> ctrl_sca = <span style="color: #0000ff;">new</span><span style="color: #000000;"> BMap.ScaleControl( {        anchor : BMAP_ANCHOR_BOTTOM_LEFT    });    map.addControl(ctrl_sca);}initMap();</span><span style="color: #008000;">//</span><span style="color: #008000;">创建和初始化地图</span>&lt;/script&gt;</pre></div>&nbsp;</div><div>&nbsp;</div><script type="text/javascript">// <![CDATA[//创建和初始化地图函数：function initMap() {    createMap(114.025974, 22.546054);//创建地图    setMapEvent();//设置地图事件    addMapControl();//向地图添加控件}function searchMap() {    var area = document.getElementById("input").value;    var ls = new BMap.LocalSearch(map);    ls.setSearchCompleteCallback(function(rs) {        if (ls.getStatus() == BMAP_STATUS_SUCCESS) {            var poi = rs.getPoi(0);            if (poi) {                createMap(poi.point.lng, poi.point.lat);//创建地图            setMapEvent();//设置地图事件            addMapControl();//向地图添加控件        }    }})    ;    ls.search(area);}//创建地图函数：function createMap(x, y) {    var map = new BMap.Map("dituContent");//在百度地图容器中创建一个地图    var point = new BMap.Point(x, y);//定义一个中心点坐标    map.centerAndZoom(point, 12);//设定地图的中心点和坐标并将地图显示在地图容器中    window.map = map;//将map变量存储在全局}//地图事件设置函数：function setMapEvent() {    map.enableDragging();//启用地图拖拽事件，默认启用(可不写)    map.enableScrollWheelZoom();//启用地图滚轮放大缩小    map.enableDoubleClickZoom();//启用鼠标双击放大，默认启用(可不写)    map.enableKeyboard();//启用键盘上下左右键移动地图}//地图控件添加函数：function addMapControl() {    //向地图中添加缩放控件    var ctrl_nav = new BMap.NavigationControl( {        anchor : BMAP_ANCHOR_TOP_LEFT,        type : BMAP_NAVIGATION_CONTROL_LARGE    });    map.addControl(ctrl_nav);    //向地图中添加缩略图控件    var ctrl_ove = new BMap.OverviewMapControl( {        anchor : BMAP_ANCHOR_BOTTOM_RIGHT,        isOpen : 1    });    map.addControl(ctrl_ove);    //向地图中添加比例尺控件    var ctrl_sca = new BMap.ScaleControl( {        anchor : BMAP_ANCHOR_BOTTOM_LEFT    });    map.addControl(ctrl_sca);}initMap();//创建和初始化地图// ]]&gt;</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;nbsp;先看效果：&lt;/p&gt;
&lt;!--引用百度地图API--&gt;
&lt;p&gt;&lt;style&gt;&amp;lt;!–&lt;br&gt;.iw_poi_title {&lt;br&gt;    color: #CC5522;&lt;br&gt;    font-size: 14px;&lt;br&gt;    font-weight: b
      
    
    </summary>
    
    
      <category term="百度地图" scheme="http://yoursite.com/tags/%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>博客园评论（回复、引用）的实现</title>
    <link href="http://yoursite.com/2012/07/25/1%E3%80%81%E5%8D%9A%E5%AE%A2%E5%9B%AD%E8%AF%84%E8%AE%BA%EF%BC%88%E5%9B%9E%E5%A4%8D%E3%80%81%E5%BC%95%E7%94%A8%EF%BC%89%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <id>http://yoursite.com/2012/07/25/1、博客园评论（回复、引用）的实现/</id>
    <published>2012-07-24T16:58:00.000Z</published>
    <updated>2022-03-20T04:22:59.341Z</updated>
    
    <content type="html"><![CDATA[<p>使用过博客园评论功能的人都知道，点击回复，光标会移到文本框里并在文本框加入@XXX；点击引用，在文本框加入@XXX跟回复的内容。</p><p>这里我想实现的就是光标移动并向textarea加入文字</p><p>第一步：点击加入文字（假设已得到用户名张三、李四）</p><p>先看效果:(点击回复)</p><style><!--.pointer {        margin-left: 50px;        cursor: pointer;            color: #ffa800;    }--></style><script type="text/javascript">// <![CDATA[function insert(con){var _abc=document.getElementById('reply_text').value;_abc=_abc+con;document.getElementById('reply_text').value=_abc}// ]]&gt;</script><p>一楼：张三<a class="pointer" onclick="insert('@张三\n')">回复</a><br>二楼：李四<a class="pointer" onclick="insert('@李四\n')">回复</a></p><p><textarea id="reply_text" rows="5"></textarea></p><a id="more"></a><p>代码</p><div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #800000;"><br>    .pointer </span><span style="background-color: #f5f5f5; color: #000000;">{</span><span style="background-color: #f5f5f5; color: #ff0000;"><br>        margin-left</span><span style="background-color: #f5f5f5; color: #000000;">:</span><span style="background-color: #f5f5f5; color: #0000ff;"> 50px</span><span style="background-color: #f5f5f5; color: #000000;">;</span><span style="background-color: #f5f5f5; color: #ff0000;"><br>        cursor</span><span style="background-color: #f5f5f5; color: #000000;">:</span><span style="background-color: #f5f5f5; color: #0000ff;"> pointer</span><span style="background-color: #f5f5f5; color: #000000;">;</span><span style="background-color: #f5f5f5; color: #ff0000;"><br>        color</span><span style="background-color: #f5f5f5; color: #000000;">:</span><span style="background-color: #f5f5f5; color: #0000ff;"> #ffa800</span><span style="background-color: #f5f5f5; color: #000000;">;</span><br>    <span style="background-color: #f5f5f5; color: #000000;">}</span><br><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">=”text/javascript”</span><span style="color: #0000ff;">&gt;</span><br><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> insert(con)<br>{</span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> _abc</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">document.getElementById(</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">reply_text</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">).value;<br>_abc</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">_abc</span><span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;">con;<br>document.getElementById(</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">reply_text</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">).value</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">_abc<br>}<br></span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"><br>一楼：张三</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">=”pointer”</span><span style="color: #ff0000;"> onclick</span><span style="color: #0000ff;">=”insert(‘@张三\n’)”</span><span style="color: #0000ff;">&gt;</span>回复<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a</span><span style="color: #0000ff;">/&gt;&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"><br>二楼：李四</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">=”pointer”</span><span style="color: #ff0000;"> onclick</span><span style="color: #0000ff;">=”insert(‘@李四\n’)”</span><span style="color: #0000ff;">&gt;</span>回复<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a</span><span style="color: #0000ff;">/&gt;&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">textarea </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=”reply_text”</span><span style="color: #ff0000;"> rows</span><span style="color: #0000ff;">=”5”</span><span style="color: #ff0000;"> cols</span><span style="color: #0000ff;">=”20”</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">textarea</span><span style="color: #0000ff;">&gt;</span></pre><br></div><p>&nbsp;</p><p>第二步：点击移动光标</p><p>代码：</p><div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a </span><span style="color: #ff0000;">onclick</span><span style="color: #0000ff;">=”moveEnd(reply_text)”</span><span style="color: #0000ff;">&gt;</span>移动光标<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">a</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">textarea </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=”reply_text”</span><span style="color: #ff0000;"> rows</span><span style="color: #0000ff;">=”5”</span><span style="color: #ff0000;"> cols</span><span style="color: #0000ff;">=”20”</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">textarea</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><br><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> moveEnd(obj){<br>    obj.focus();<br>    </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> len </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> obj.value.length;<br>    </span><span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (document.selection) {<br>        </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> sel </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> obj.createTextRange();<br>        sel.moveStart(</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">character</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">,len);<br>        sel.collapse();<br>        sel.select();<br>    } </span><span style="background-color: #f5f5f5; color: #0000ff;">else</span> <span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (</span><span style="background-color: #f5f5f5; color: #0000ff;">typeof</span><span style="background-color: #f5f5f5; color: #000000;"> obj.selectionStart </span><span style="background-color: #f5f5f5; color: #000000;">==</span> <span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">number</span><span style="background-color: #f5f5f5; color: #000000;">‘</span> <span style="background-color: #f5f5f5; color: #000000;">&amp;&amp;</span> <span style="background-color: #f5f5f5; color: #0000ff;">typeof</span><span style="background-color: #f5f5f5; color: #000000;"> obj.selectionEnd </span><span style="background-color: #f5f5f5; color: #000000;">==</span> <span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">number</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">) {<br>        obj.selectionStart </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> obj.selectionEnd </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> len;<br>    }<br>}<br></span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><br> </pre><br></div><p>&nbsp;</p><p>加在一起后的效果：（点击回复）</p><script type="text/javascript">// <![CDATA[function moveEnd(obj){    obj.focus();    var len = obj.value.length;    if (document.selection) {        var sel = obj.createTextRange();        sel.moveStart('character',len);        sel.collapse();        sel.select();    } else if (typeof obj.selectionStart == 'number' && typeof obj.selectionEnd == 'number') {        obj.selectionStart = obj.selectionEnd = len;    }}// ]]&gt;</script><p>一楼：张三<a class="pointer" onclick="insert('@张三\n'),moveEnd(reply_text)">回复</a><br>二楼：李四<a class="pointer" onclick="insert('@李四\n'),moveEnd(reply_text)">回复</a></p><p></p><p>全部代码：</p><div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #800000;"><br>    .pointer </span><span style="background-color: #f5f5f5; color: #000000;">{</span><span style="background-color: #f5f5f5; color: #ff0000;"><br>        margin-left</span><span style="background-color: #f5f5f5; color: #000000;">:</span><span style="background-color: #f5f5f5; color: #0000ff;"> 50px</span><span style="background-color: #f5f5f5; color: #000000;">;</span><span style="background-color: #f5f5f5; color: #ff0000;"><br>        cursor</span><span style="background-color: #f5f5f5; color: #000000;">:</span><span style="background-color: #f5f5f5; color: #0000ff;"> pointer</span><span style="background-color: #f5f5f5; color: #000000;">;</span><span style="background-color: #f5f5f5; color: #ff0000;"><br>        color</span><span style="background-color: #f5f5f5; color: #000000;">:</span><span style="background-color: #f5f5f5; color: #0000ff;"> #ffa800</span><span style="background-color: #f5f5f5; color: #000000;">;</span><br>    <span style="background-color: #f5f5f5; color: #000000;">}</span><br><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">=”text/javascript”</span><span style="color: #0000ff;">&gt;</span><br><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> insert(con)<br>{</span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> t</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">document.getElementById(</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">reply_text</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">).value;<br>t</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">t</span><span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;">con;<br>document.getElementById(</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">reply_text</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">).value</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">t<br>}<br><br></span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> moveEnd(obj){<br>    obj.focus();<br>    </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> len </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> obj.value.length;<br>    </span><span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (document.selection) {<br>        </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> sel </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> obj.createTextRange();<br>        sel.moveStart(</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">character</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">,len);<br>        sel.collapse();<br>        sel.select();<br>    } </span><span style="background-color: #f5f5f5; color: #0000ff;">else</span> <span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (</span><span style="background-color: #f5f5f5; color: #0000ff;">typeof</span><span style="background-color: #f5f5f5; color: #000000;"> obj.selectionStart </span><span style="background-color: #f5f5f5; color: #000000;">==</span> <span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">number</span><span style="background-color: #f5f5f5; color: #000000;">‘</span> <span style="background-color: #f5f5f5; color: #000000;">&amp;&amp;</span> <span style="background-color: #f5f5f5; color: #0000ff;">typeof</span><span style="background-color: #f5f5f5; color: #000000;"> obj.selectionEnd </span><span style="background-color: #f5f5f5; color: #000000;">==</span> <span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">number</span><span style="background-color: #f5f5f5; color: #000000;">‘</span><span style="background-color: #f5f5f5; color: #000000;">) {<br>        obj.selectionStart </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> obj.selectionEnd </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> len;<br>    }<br>}<br></span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"><br>一楼：张三</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">=”pointer”</span><span style="color: #ff0000;"> onclick</span><span style="color: #0000ff;">=”insert(‘@张三\n’),moveEnd(reply_text)”</span><span style="color: #0000ff;">&gt;</span>回复<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a</span><span style="color: #0000ff;">/&gt;&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"><br>二楼：李四</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">=”pointer”</span><span style="color: #ff0000;"> onclick</span><span style="color: #0000ff;">=”insert(‘@李四\n’),moveEnd(reply_text)”</span><span style="color: #0000ff;">&gt;</span>回复<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a</span><span style="color: #0000ff;">/&gt;&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">textarea </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=”reply_text”</span><span style="color: #ff0000;"> rows</span><span style="color: #0000ff;">=”5”</span><span style="color: #ff0000;"> cols</span><span style="color: #0000ff;">=”20”</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">textarea</span><span style="color: #0000ff;">&gt;</span></pre><br></div><p>&nbsp;</p><p>&nbsp;</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用过博客园评论功能的人都知道，点击回复，光标会移到文本框里并在文本框加入@XXX；点击引用，在文本框加入@XXX跟回复的内容。&lt;/p&gt;
&lt;p&gt;这里我想实现的就是光标移动并向textarea加入文字&lt;/p&gt;
&lt;p&gt;第一步：点击加入文字（假设已得到用户名张三、李四）&lt;/p&gt;
&lt;p&gt;先看效果:(点击回复)&lt;/p&gt;
&lt;style&gt;&lt;!--
.pointer {
        margin-left: 50px;
        cursor: pointer;    
        color: #ffa800;
    }
--&gt;&lt;/style&gt;

&lt;script type=&quot;text/javascript&quot;&gt;// &lt;![CDATA[
function insert(con)
{var _abc=document.getElementById(&#39;reply_text&#39;).value;
_abc=_abc+con;
document.getElementById(&#39;reply_text&#39;).value=_abc
}
// ]]&amp;gt;&lt;/script&gt;

&lt;p&gt;一楼：张三&lt;a class=&quot;pointer&quot; onclick=&quot;insert(&#39;@张三\n&#39;)&quot;&gt;回复&lt;/a&gt;&lt;br&gt;二楼：李四&lt;a class=&quot;pointer&quot; onclick=&quot;insert(&#39;@李四\n&#39;)&quot;&gt;回复&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;textarea id=&quot;reply_text&quot; rows=&quot;5&quot;&gt;&lt;/textarea&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/tags/JavaScript/"/>
    
  </entry>
  
</feed>
